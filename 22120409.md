# Họ và tên: Võ Văn Tùng
# MSSV: 22120409
# Homework 2: Innovate Solutions Project Access Management

## Step 1: Create Project Groups and Users
- Set up two new groups named after the two teams: one for developers and one for testers.
    - Dùng lệnh:
        ```bash
        sudo groupadd alpha_dev
        sudo groupadd beta_test
        ```
    - Giải thích: Lệnh `groupadd` tạo nhóm mới trong hệ thống.
- Create the following user accounts.
    - Dùng lệnh:
        ```bash
        sudo useradd -m -s /bin/bash dev_lead
        sudo useradd -m -s /bin/bash dev_junior

        sudo useradd -m -s /bin/bash tester_lead
        sudo useradd -m -s /bin/bash tester_junior

        sudo useradd -m -s /bin/bash guest_user
        ```
    - Giải thích: Lệnh `useradd` tạo người dùng mới với tùy chọn `-m` để tạo thư mục home và `-s` để chỉ định shell.
- Set a temporary password for each user (e.g., password123 for lab use only).
    - Dùng lệnh:
        ```bash
        echo "dev_lead:password123" | sudo chpasswd
        echo "dev_junior:password123" | sudo chpasswd
        echo "tester_lead:password123" | sudo chpasswd
        echo "tester_junior:password123" | sudo chpasswd
        echo "guest_user:password123" | sudo chpasswd
        ```
    - Giải thích: Lệnh `chpasswd` thay đổi mật khẩu của người dùng.
- Confirm that the new users and groups have been correctly added by inspecting the relevant system files.
    - Dùng lệnh:
        ```bash
        cat /etc/group | grep -E "alpha_dev|beta_test"
        cat /etc/passwd | grep -E "dev_lead|dev_junior|tester_lead|tester_junior|guest_user"
        ```
    - Giải thích: file `/etc/group` chứa thông tin về các nhóm, file `/etc/passwd` chứa thông tin về người dùng, lệnh `grep -E` tìm kiếm các dòng chứa tên nhóm hoặc người dùng.
- Checkpoint Question: What group is assigned to new users by default if no group is specified?
    - Trả lời: Mặc định thì người dùng mới được gán vào một nhóm có cùng tên với tên người dùng. Ví  dụ người dùng `dev_lead` sẽ được gán vào nhóm `dev_lead` nếu không chỉ định nhóm khác.

## Step 2: Assign Users to Groups
- Add dev_lead and dev_junior to the development team group.
    - Dùng lệnh:
        ```bash
        sudo usermod -aG alpha_dev dev_lead
        sudo usermod -aG alpha_dev dev_junior
        ```
    - Giải thích: Lệnh `usermod -aG` thêm người dùng vào nhóm mà không xóa họ khỏi các nhóm hiện có.
- Add tester_lead and tester_junior to the testing team group.
    - Dùng lệnh:
        ```bash
        sudo usermod -aG beta_test tester_lead
        sudo usermod -aG beta_test tester_junior
        ```
    - Giải thích: Tương tự như trên, thêm người dùng vào nhóm mà không xóa họ khỏi các nhóm hiện có.
- Assign dev_lead to both groups (developer and tester) so they can read testing
reports.
    - Dùng lệnh:
        ```bash
        sudo usermod -aG alpha_dev,beta_test dev_lead
        ```
    - Giải thích: Lệnh này thêm dev_lead vào nhóm beta_test, cho phép họ truy cập cả tài nguyên development và testing.
- Checkpoint Question: After adding dev_lead to both groups, use a command to list their group memberships. What do you observe?
    - Dùng lệnh:
        ```bash
        groups dev_lead
        ```
    - Trả lời: Lệnh này hiển thị tất cả các nhóm mà dev_lead thuộc về. Sau khi thực hiện lệnh groups dev_lead, ta quan sát thấy dev_lead thuộc ba nhóm:
        - Nhóm chính (primary group): dev_lead
        - Nhóm bổ sung: alpha_dev và beta_test

        Điều này cho phép dev_lead có quyền truy cập vào cả tài nguyên của nhóm phát triển và nhóm kiểm thử.

## Step 3: Set Up Project Directories
- Create a parent directory called /projects, if it doesn’t exist.
    - Dùng lệnh:
        ```bash
        sudo mkdir -p /projects
        ```
    - Giải thích: Lệnh `mkdir -p` tạo thư mục và các thư mục cha nếu chúng chưa tồn tại.

- Inside /projects, create a directory for the Alpha developers (/projects/alpha) and Beta reports (/projects/beta_reports)
    - Dùng lệnh:
        ```bash 
        sudo mkdir /projects/alpha
        sudo mkdir /projects/beta_reports
        ```
    - Giải thích: Lệnh `mkdir` tạo các thư mục con bên trong thư mục /projects.

- Assign group ownership of each directory
    - Dùng lệnh:
        ```bash
        sudo chgrp alpha_dev /projects/alpha
        sudo chgrp beta_test /projects/beta_reports
        ```
    - Giải thích: Lệnh `chgrp` thay đổi quyền sở hữu nhóm của thư mục.

- Verify that group ownership has been applied correctly.
    - Dùng lệnh:
        ```bash
        ls -ld /projects/alpha /projects/beta_reports
        ```
    - Giải thích: Lệnh `ls -ld` hiển thị thông tin chi tiết về các thư mục, bao gồm quyền sở hữu nhóm.

- Checkpoint Question: What is the default owner and group of a directory created by the root user?
    - Trả lời: Mặc định, khi thư mục được tạo bởi người dùng root, chủ sở hữu và nhóm của thư mục đó là root.
    
## Step 4: Set Up Directory Permissions
- For the Alpha project directory, Ensure that owner and group have full access (read/write/execute), Ensure that others have no access
    - Dùng lệnh:
        ```bash
        sudo chmod 770 /projects/alpha
        ```
    - Giải thích: Lệnh `chmod 770` thiết lập quyền truy cập cho chủ sở hữu và nhóm là đọc, ghi và thực thi (7), trong khi người khác không có quyền truy cập (0).

- For the Beta reports directory, Ensure that the owner has full access, Ensure that the group has read and execute permissions, but not write, Ensure that others have no access
    - Dùng lệnh:
        ```bash
        sudo chmod 750 /projects/beta_reports
        ```
    - Giải thích: Lệnh `chmod 750` thiết lập quyền truy cập cho chủ sở hữu là đọc, ghi và thực thi (7), nhóm có quyền đọc và thực thi (5), trong khi người khác không có quyền truy cập (0).

- Checkpoint Question: Translate these permission needs into octal notation. What should the three-digit permissions be for each directory?
    - Trả lời: 
        - Đối với thư mục Alpha: Quyền truy cập là 770, trong đó:
            - Chủ sở hữu (owner): 7 (đọc, ghi, thực thi)
            - Nhóm (group): 7 (đọc, ghi, thực thi)
            - Người khác (others): 0 (không có quyền truy cập)
        - Đối với thư mục Beta reports: Quyền truy cập là 750, trong đó:
            - Chủ sở hữu (owner): 7 (đọc, ghi, thực thi)
            - Nhóm (group): 5 (đọc, thực thi)
            - Người khác (others): 0 (không có quyền truy cập)

## Step 5: Test Access to the Alpha Directory
- Log in as dev_junior and try to, Navigate into /projects/alpha, Create a file called dev_file.txt, List the directory contents
    - Dùng lệnh:
        ```bash
        su - dev_junior
        cd /projects/alpha
        touch dev_file.txt
        ls -l
        ```
    - Giải thích: Lệnh `su - dev_junior` chuyển sang người dùng dev_junior, `cd` di chuyển vào thư mục, `touch` tạo tệp mới, và `ls -l` liệt kê nội dung thư mục với chi tiết.

- Log in as guest_user and try to: Navigate into /projects/alpha
    - Dùng lệnh:
        ```bash
        su - guest_user
        cd /projects/alpha
        ```
    - Giải thích: Lệnh `su - guest_user` chuyển sang người dùng guest_user và `cd` cố gắng di chuyển vào thư mục.

- Checkpoint Question: Why is dev_junior able to write to the directory? Why is
guest_user blocked?
    - Trả lời: 
        - dev_junior có thể ghi vào thư mục /projects/alpha vì nó là thành viên của nhóm alpha_dev, và nhóm này có quyền ghi (write) trên thư mục đó (quyền nhóm là 7).
        - guest_user bị chặn truy cập vào thư mục /projects/alpha vì nó không thuộc nhóm alpha_dev và quyền của người khác (others) trên thư mục này là 0, nghĩa là không có quyền truy cập nào cả.

## Step 6: Test Access to Beta Reports Directory
- Log in as tester_junior and attempt to: Navigate to /projects/beta_reports, Create a new file
    - Dùng lệnh:
        ```bash
        su - tester_junior
        cd /projects/beta_reports
        touch test_report.txt
        ```
    - Giải thích: Lệnh `su - tester_junior` chuyển sang người dùng tester_junior, `cd` di chuyển vào thư mục, và `touch` cố gắng tạo tệp mới.

- As root, create a file called sample_report.txt inside the Beta directory with
sample text.
    - Dùng lệnh:
        ```bash
        sudo bash -c 'echo "Sample report." > /projects/beta_reports/sample_report.txt'
        ```
    - Giải thích: Lệnh này sử dụng `sudo` để chạy một lệnh bash với quyền root, tạo tệp sample_report.txt và ghi nội dung vào đó.

- Log in as dev_lead and try to: Read the contents of sample_report.txt, Delete sample_report.txt
    - Dùng lệnh:
        ```bash
        su - dev_lead
        cat /projects/beta_reports/sample_report.txt
        rm /projects/beta_reports/sample_report.txt
        ```
    - Giải thích: Lệnh `su - dev_lead` chuyển sang người dùng dev_lead, `cat` đọc nội dung tệp, và `rm` cố gắng xóa tệp.

- Checkpoint Questions:
●​ Was tester_junior able to write to the directory? Why or why not?
●​ Could dev_lead read or delete the file? Explain based on group memberships and
permission settings.
    - Trả lời:
        - tester_junior không thể ghi vào thư mục /projects/beta_reports vì nó là thành viên của nhóm beta_test, và nhóm này chỉ có quyền đọc và thực thi (5) trên thư mục đó, không có quyền ghi (write).
        - dev_lead có thể đọc nội dung của sample_report.txt vì nó là thành viên của nhóm beta_test, và nhóm này có quyền đọc (read) trên thư mục. Tuy nhiên, dev_lead không thể xóa tệp sample_report.txt vì nó không có quyền ghi (write) trên thư mục /projects/beta_reports, do đó không thể xóa tệp trong thư mục này.

## Final Reflection
- What do directory execute (x) permissions allow users to do?
    - Trả lời: Quyền thực thi (execute - x) trên thư mục cho phép người dùng truy cập vào nội dung bên trong thư mục đó. Cụ thể, nếu một người dùng có quyền thực thi trên một thư mục, họ có thể:
        - Di chuyển vào thư mục đó bằng lệnh `cd`.
        - Truy cập các tệp và thư mục con bên trong thư mục đó (nếu có quyền đọc trên các tệp/thư mục con).
        - Thực thi các tệp thực thi bên trong thư mục đó.

- What are the consequences of setting group permissions without also configuring the correct group ownership?
    - Trả lời: Nếu chỉ thiết lập quyền nhóm mà không cấu hình đúng quyền sở hữu nhóm, có thể dẫn đến các vấn đề:
        - Nếu một người dùng không thuộc nhóm sở hữu của thư mục hoặc tệp, họ sẽ không thể tận dụng các quyền nhóm đã thiết lập, dẫn đến việc không thể truy cập hoặc thao tác với tài nguyên đó.
        - Hệ thống quản lý quyền dựa trên nhóm sẽ không hoạt động đúng.

- What command would you use to safely assign a user to multiple groups without
removing existing memberships?
    - Trả lời: Để thêm một người dùng vào nhiều nhóm mà không xóa các thành viên hiện có, sử dụng lệnh:
        ```bash
        sudo usermod -aG <group1>,<group2> <username>
        ```
      Trong đó, `-aG` là tùy chọn để thêm người dùng vào các nhóm bổ sung mà không xóa họ khỏi các nhóm hiện có.

## Extension Challenge (Optional)
- Modify the Alpha directory so that team members can write files but cannot delete each other’s files.
    - Dùng lệnh:
        ```bash
        sudo chmod 1770 /projects/alpha
        ```
    - Giải thích: Số 1 ở đầu (sticky bit) đảm bảo rằng chỉ chủ sở hữu của tệp, chủ sở hữu file hoặc người dùng root mới có thể xóa hoặc đổi tên các tệp trong thư mục, cho dù các thành viên khác của nhóm có quyền ghi.